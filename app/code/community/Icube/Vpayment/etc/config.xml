<?xml version="1.0"?>
<config>
    <modules>
        <Icube_Vpayment>
            <version>0.1.5</version>
        </Icube_Vpayment>
    </modules>
    <frontend>
        <routers>
            <vpayment>
                <use>standard</use>
                <args>
                    <module>Icube_Vpayment</module>
                    <frontName>vpayment</frontName>
                </args>
            </vpayment>
            <checkout>
                <args>
                    <modules>
                        <Icube_Vpayment before="Mage_Checkout">Icube_Vpayment</Icube_Vpayment>
                    </modules>
                </args>
            </checkout>
        </routers>
        <layout>
            <updates>
                <vpayment>
                    <file>vpayment.xml</file>
                </vpayment>
            </updates>
        </layout>
    </frontend> 
    <global>
        <models>
            <vpayment>
                <class>Icube_Vpayment_Model</class>
                <resourceModel>vpayment_resource</resourceModel>
            </vpayment>
            <vpayment_resource>
                <class>Icube_Vpayment_Model_Resource</class>
                <entities>
                    <vpayment>
                        <table>veritrans</table>
                    </vpayment>
                    <program>
                        <table>promo_program</table>
                    </program>
                </entities>
            </vpayment_resource>
            <salesrule>
                <rewrite>
                    <rule_condition_address>Icube_Vpayment_Model_Rule_Condition_Address</rule_condition_address>
                </rewrite>
            </salesrule>
            <checkout>
                <rewrite>
                    <type_onepage>Icube_Vpayment_Model_Type_Onepage</type_onepage>
                </rewrite>
            </checkout>
        </models>
        <resources>
            <vpayment_setup>
                <setup>
                    <module>Icube_Vpayment</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </vpayment_setup>
            <vpayment_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </vpayment_write>
            <vpayment_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </vpayment_read>
        </resources>
        <blocks>
            <vpayment>
                <class>Icube_Vpayment_Block</class>
            </vpayment>
        </blocks>
        <helpers>
            <vpayment>
                <class>Icube_Vpayment_Helper</class>
            </vpayment>
        </helpers>
        <payment>
            <vpayment>
                <types>
                    <AE>
                        <code>AE</code>
                        <name>American Express</name>
                        <order>0</order>
                    </AE>
                    <VI>
                        <code>VI</code>
                        <name>Visa</name>
                        <order>10</order>
                    </VI>
                    <MC>
                        <code>MC</code>
                        <name>MasterCard</name>
                        <order>20</order>
                    </MC>
                    <DI>
                        <code>DI</code>
                        <name>Discover</name>
                        <order>30</order>
                    </DI>
                    <SM>
                        <code>SM</code>
                        <name>Maestro/Switch</name>
                        <order>40</order>
                    </SM>
                    <SO>
                        <code>SO</code>
                        <name>Solo</name>
                        <order>45</order>
                    </SO>
                    <JCB>
                        <code>JCB</code>
                        <name>JCB</name>
                        <order>50</order>
                    </JCB>
                    <OT>
                        <code>OT</code>
                        <name>Other</name>
                        <order>1000</order>
                    </OT>
                </types>
            </vpayment>
            <groups>
                <offline>Offline Payment Methods</offline>
            </groups>
        </payment>
        <events>
            <sales_order_invoice_save_after>
                <observers>
                    <icube_vpayment_capture_vt>
                        <type>singleton</type>
                        <class>vpayment/observer_veritrans</class>
                        <method>captureVT</method>
                    </icube_vpayment_capture_vt>
                </observers>
            </sales_order_invoice_save_after>
            <sales_order_place_after>
                <observers>
                    <icube_check_authorize_order>
                        <type>singleton</type>
                        <class>vpayment/observer_veritrans</class>
                        <method>checkAuthorizeOrder</method>
                    </icube_check_authorize_order>
                </observers>
            </sales_order_place_after>
            <sales_order_item_cancel>
                <observers>
                    <icube_cancel_order>
                        <type>singleton</type>
                        <class>vpayment/observer_veritrans</class>
                        <method>cancelOrder</method>
                    </icube_cancel_order>
                </observers>
            </sales_order_item_cancel>
        </events>
    </global>
    <default>
        <payment>
            <vpayment>
                <active>1</active>
                <model>vpayment/vpayment</model>
                <order_status>processing</order_status>
                <title>Veritrans Payment Method</title>
                <secure_enable>0</secure_enable>
            </vpayment>
         </payment>
    </default>
    <admin>
        <routers>
            <vpayment>
                <use>admin</use>
                <args>
                    <module>Icube_Vpayment</module>
                    <frontName>vpayment</frontName>
                </args>
            </vpayment>
        </routers>
    </admin>
    <adminhtml>
        <layout>
            <updates>
                <vpayment>
                    <file>vpayment.xml</file>
                </vpayment>
            </updates>
        </layout>
        <events>
            <adminhtml_block_html_before>
                <observers>
                    <vpayment_grid_column>
                        <type>model</type>
                        <model>vpayment/adminhtml_observer</model>
                        <method>addColumnToResource</method>
                    </vpayment_grid_column>
                </observers>
            </adminhtml_block_html_before>
            <sales_order_grid_collection_load_before>
                <observers>
                    <vpayment_order_prepare_collection>
                        <type>model</type>
                        <model>vpayment/adminhtml_observer</model>
                        <method>prepareCollection</method>
                    </vpayment_order_prepare_collection>
                </observers>
            </sales_order_grid_collection_load_before>
        </events>
    </adminhtml>
</config>